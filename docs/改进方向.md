---
# 赛道与任务概述

本赛道由魔方工作室（暗区突围 / 暗区突围无限）与 MagicDawn 联合主办。目标是用 AI 压缩含不同时刻（Time-of-Day, TOD）光照贴图，既要显著降低资源包体积，又要保证实时解压性能与光照质量——这是衡量方案可落地性的三大核心维度。

赛题分两部分：
- 赛题1（必做）：光照贴图压缩 — 提交压缩文件与解压脚本，按自动评测的客观指标评分（示例：PSNR / SSIM / LPIPS）。
- 赛题2（可选）：将赛题1算法整合进 UE 渲染管线并打包（工程集成与性能验证）。

优先评估指标（按重要性排序，需在实验设计中明确权重）：
- 解压速度（Decompression speed）：关键于实时渲染和游戏端体验，通常要求极低的单帧延迟与可预测的吞吐。
- 压缩率 / 体积（Compression rate / Size）：压缩后存储与分发成本直接受此影响（模型权重 + 表/纹理等）。
- 压缩质量（Reconstruction quality）：客观指标（PSNR / SSIM / LPIPS）与主观视觉感受（尤其 temporally consistent 的表现）。

说明：在给出改进方向时，我会明确说明每种方法在这三项指标上的典型表现与折衷，以便按赛题评分侧重点选择方案。

本文档仅讨论算法/方法与实验流程（不含 UE 集成细节）。目标：给出可执行的优先级路线、实现要点、超参建议与验证方案，便于快速落地与评测。

---

## 顶级优先（首选方案 — 最大收益、可落地）

优先级排序（推荐先后顺序）：

1) 多分辨率特征网格（Hash / Multi-resolution feature grid） + 小型 MLP — 推荐指数：★★★★★

  - 理念：用多尺度特征表对空间（可扩展到时间）做局部编码，然后用一个小的 MLP 解码为 ΔRGB（或直接 RGB）。即 Instant-NGP 风格，但为 2D(+time) 场景做简化和工程化实现。
  - 优势：训练收敛快、推理极快、能有效表达高频细节且模型体积可控（表格 + 小 MLP）。非常适合游戏端（低延迟、可量化）。
  - 关键实现要点：
    - 用 multi-resolution feature grids（例如分辨率级别 16,32,64,128），每级保存小向量（C 通道，C∈[8,32]）。
    - 对 (x,y) 使用逐级双线性/三线性插值取样，时间可以：
      - 方法 A：把 time 作为额外维度扩展为 3D grid（若内存允许）；
      - 方法 B（更节省）：对 time 做独立的编码（hash 或 Fourier）并拼接到采样特征后输入 MLP。
    - Decoder：2–4 层 MLP，hidden 32–128，输出 3 通道 ΔRGB。使用 MSE + optional perceptual loss。
    - 存储/导出：保存 feature grids（整数组/float16）+ MLP 权重。feature grid 可量化到 8-bit/16-bit 或采用哈希表减少内存。
  - 推荐超参（初始）：
    - levels = [16,32,64,128]
    - channels_per_level = 16
    - MLP hidden = 64, layers = 3
    - optimizer = AdamW, lr = 1e-3（feature grids） -> 1e-4（finetune），weight_decay=1e-5
  - 验证：与当前 SIREN 基线同等训练步骤下对比 PSNR/LPIPS/推理延迟/模型体积。

2) Baseline Encoder -> 低分辨率特征图（latent texture）+ 小 MLP（纹理采样式） — 推荐指数：★★★★☆

  - 理念：把 baseline（静态基准图）编码为低分辨率特征纹理（C×H/d×W/d）。运行时按像素双线性采样该特征并与 time encoding 一起输入小 MLP 预测 ΔRGB。对游戏端友好（纹理采样硬件优化）。
  - 优势：把大量空间信息以纹理形式保存，模型只需学习时间变化与高频补偿，便于量化与纹理压缩格式存储（如 BCn）。
  - 关键实现要点：
    - BaselineEncoder：小型 CNN，将 baseline（H×W×3）编码为 F0 (C, H/d, W/d)，d 常见取 4/8/16。
    - 训练时随机采样像素位置 (x,y)，从 F0 双线性采样得到 f0(x,y)，与时间编码拼接输入 MLP。
    - 选择存储格式：将 F0 量化为 8-bit 或导出为压缩纹理（便于引擎集成）。
  - 推荐超参：downscale d=8, C=16，MLP hidden=64, layers=2
  - 验证：比较体积（特征纹理 + MLP）与纯 MLP/SIREN，在相同或更低比特率下的视感/PSNR/LPIPS。

3) 时空可分解（Separable bases：空间基 × 时间系数） — 推荐指数：★★★☆☆

  - 理念：把 f(x,y,t) ≈ Σ_k A_k(x,y) * c_k(t)，其中 A_k 是空间 basis 图，c_k 为时间系数。空间基可用图像存储，时间系数用小网络拟合。
  - 优势：在平稳或周期性时间变化情况下能极大压缩数据量。
  - 关键实现要点：
    - 先对训练序列做像素级 PCA/SVD 获得初始 A_k, c_k；或用可学习方式联合优化 basis 与系数。
    - 用小 MLP 接受 time encoding 输出 c_k(t)。同时保留一个小残差网络处理高频瞬态。
  - 推荐超参：K ∈ [8, 32]；basis 分辨率可比原图低 1/2–1/8
  - 验证：扫描 K，绘制 rate-distortion 曲线，查看时间一致性指标。

---

## 中级/补充方向（可并行实验）

- 张量分解（Tucker/CP）用于 H×W×T 降秩；适合规则变化但实现复杂。
- VQ + 熵模型（端到端可学习压缩）：适合要严格控制码率时使用，但实现与训练复杂度高。
- 量化感知训练（QAT）：推荐在已选方案稳定后加入（8-bit / 权重量化），便于发布。
- 增加感知损失（LPIPS / VGG）和时间一致性损失（temporal gradient 或基于光流的重投影）来降低闪烁并提升视觉质量。

---

## 验证指标与实验设计（必做）

建议的基础度量与采样策略：

- 视觉质量：PSNR / SSIM / LPIPS（主观感受补充）
- 时间一致性：帧间差分指标、temporal LPIPS 或基于光流的重投影误差
- 性能：单帧推理时间（CPU / GPU）、批量推理吞吐、内存占用
- 体积：最终压缩文件大小（模型 weights + feature tables + latent textures）

实验协议（保证可比）：

1) 基线：目前 SIREN/DeltaField 实现，固定训练预算（例如固定步数或 epoch、相同采样策略）。
2) 每个候选方法在相同训练预算下训练 3 次（平均/方差）并记录指标。
3) 对比曲线：绘制 Rate-Distortion（体积 vs PSNR/LPIPS），并报告推理延迟。

---

## 推荐的短期实施计划（开发优先级与里程碑）

周期为 2–4 周的短期计划：

1) 周 1：实现 Hash-grid + 小 MLP 的最简原型（CPU/GPU 可跑），验证能否在短训练内超越 SIREN 的收敛速度与质量。
   - 输出：可训练脚本、导出 feature grids + MLP 的示例 checkpoint。

2) 周 2：实现 BaselineEncoder + latent texture 训练与导出管线，测试纹理量化（8-bit）对质量的影响。

3) 周 3：对最优方法进行 ablation（levels / channels / MLP size / time encoding），并做 RD 曲线。

交付物：训练代码、导出脚本、RD 曲线、推理延迟与体积表格。

---

## 风险与注意事项

- 瞬态高频变化（如强局部闪烁）对低秩/分解方法不友好，需用残差网络补偿。
- VQ 与熵模型训练需要较大计算资源与调参成本。
- 游戏端集成（UE）需考虑数据格式（纹理压缩、内存布局、采样精度）。
